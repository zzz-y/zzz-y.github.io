---
title: 原型与原型链
date: 2018-11-18 21:22:57
tags:
categories: js
---
> JavaScript 常被描述为一种**基于原型的语言** (prototype-based language)——每个对象拥有一个**原型对象**，对象以其原型为模板、从原型继承方法和属性。原型对象也可能拥有原型，并从中继承方法和属性，一层一层、以此类推。这种关系常被称为**原型链** (prototype chain)，它解释了为何一个对象会拥有定义在其他对象中的属性和方法。
准确地说，这些属性和方法定义在Object的构造器函数(constructor functions)之上的prototype属性上，而非对象实例本身。
<!--more-->
## 对象和函数
全局函数：由浏览器声明的函数。如**Number()**、**String()**、**Boolean()**、**Object()**。
在js中，均可通过调用这些公共函数来创建对象。如：
```javascript
var str = new String('hello');

var num = new Number(123);

var b = new Boolean(true);

```
即 `var 对象 = new 构造函数();`

## `__proto__`  和 `prototype` 
###  `__proto__` 
每个对象有属性 `__proto__`，指向该对象的构造函数的原型对象，并从原型对象继承属性和方法。

作用：构成原型链，同样用于实现基于原型的继承。
### `prototype` 
每个函数都有一个 `prototype` 属性，函数的 `prototype` 属性指向了一个对象，这个对象正是调用该构造函数而创建的实例的原型。

作用：用来实现基于原型的继承与属性的共享
### 二者的关系
`__proto__` 指向创建这个对象的函数`prototype` 

```javascript
var obj = new Object({x: 1});
obj .__proto__ === Object.prototype // true
obj .toString === obj .__proto__.toString // true
```
即 `被构造的对象.__proto__ === 构造函数.prototype`

## 通过问题理解
```javascript
function People(){}
var p = new People()
p.__proto__ === People.prototype 
People.__proto__ === Function.prototype
People.prototype.__proto__ === Object.prototype
```
People函数创建了对象p，所以`p.__proto__ === People.prototype`
People函数作为对象是由Function函数创建，所以`People.__proto__ === Function.prototype`
People.prototype对象由Object函数创建，所以`People.prototype.__proto__ === Object.prototype`

## 总结
实例对象被构造了之后，能够自动引用其构造函数的原型对象。当试图访问这个实例的一个属性时，它不仅仅会在自身上搜寻，还会沿着它的原型链向上搜索，直到找到一个名字匹配的属性或到达原型链的末尾。
```javascript
var 对象 = new 函数()
被构造的对象.__proto__ === 构造函数.prototype

// 推论
var number = new Number()
number.__proto__ = Number.prototype
Number.__proto__ = Function.prototype // 因为 Number 是 Function 的实例

var object = new Object()
object.__proto__ = Object.prototype
Object.__proto__ = Function.prototype // 因为 Object 是 Function 的实例
Object.prototype.__proto__ = null

var function = new Function()
function.__proto__ = Function.prototype
Function.__proto__ == Function.prototye // 因为 Function 是 Function 的实例
```

